{% extends "base.html" %}
    {% block head %}
        <script src="{{ url_for('static', filename='js/canvasjs.min.js') }}"></script>
        <script type="text/javascript">
        function plotChart(id, title, dt){
            CanvasJS.addColorSet("amu",["#73c9e3", "#f0ad4e"]);
            var chart = new CanvasJS.Chart(id,{
                colorSet: "amu",
                title: {text: title},
                legend: {
                    verticalAlign: "bottom",
                    horizontalAlign: "center"
                },
            showInLegend: true,
            data: [{
                type: "doughnut",
                showInLegend: true,
                dataPoints: dt
            }]
            });
            chart.render();
        }
        </script>
    {% endblock %}
    {% block body %}
        {% if data and data.jobs %}
            <div class="uk-panel uk-width-1-1 uk-panel-space">
                <table class="uk-table uk-table-hover uk-table-striped uk-table-condensed">
                    <thead>
                    <tr>
                        <th>JobID</th>
                        <th>Name</th>
                        <th>Project</th>
                        <th>Status</th>
                        <th>Partition</th>
                        <th>Duration</th>
                        <th>Date</th>
                    </tr>
                    </thead>
                <tbody>
                {% for job in data.jobs|sort(attribute='id', reverse=True) %}
                    <tr>
                        <td>{{job.id}}</td>
                        <td>{{job.name}}</td>
                        <td>{{job.project}}</td>
                        <td>{{job.state}}</td>
                        <td>{{job.partition}}</td>
                        <td>{{job.duration}}</td>
                        <td>{{job.date}}</td>
                    </tr>
                {% endfor %}
                </tbody>
                </table>
            </div>
        {% endif %}
        {% if data and data.scratch %}
            <div class="uk-panel uk-width-1-1 uk-panel-space">
                <div id="canvas_for_scratch">
                <script type="text/javascript">
                    var data = [{
                        y: {{data.scratch.used}},
                        indexLabel: "Used",
                        legendText: "Used {{data.scratch.used_label}}"
                    },{
                        y: {{data.scratch.free}},
                        indexLabel: "Free",
                        legendText: "Available {{data.scratch.free_label}}"
                    }];
                    var id = "canvas_for_scratch";
                    var title = "Scratch usage: {{data.scratch.usage}}";
                    plotChart(id, title, data);
                </script>
                </div>
            </div>
        {% endif %}
    {% endblock %}